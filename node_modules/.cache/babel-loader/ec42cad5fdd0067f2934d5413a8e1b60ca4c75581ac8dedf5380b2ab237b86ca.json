{"ast":null,"code":"var _jsxFileName = \"/Users/viyondpay/opensource/dynamic_decision/front/src/App.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction App() {\n  _s();\n  // 修改数据结构：每个规则拥有自己的决策\n  const [rules, setRules] = useState([{\n    id: 1,\n    name: '规则1',\n    expression: 'age >= 18',\n    decisions: [{\n      id: 1,\n      name: '规则1决策',\n      actions: [{\n        type: 'SET',\n        key: 'result',\n        value: 'true',\n        target: 'ML_DECISION'\n      }]\n    }]\n  }, {\n    id: 2,\n    name: '规则2',\n    expression: 'age <= 18',\n    decisions: [{\n      id: 2,\n      name: '规则2决策',\n      actions: [{\n        type: 'SET',\n        key: 'result',\n        value: 'false',\n        target: 'ML_DECISION'\n      }, {\n        type: 'INCR',\n        key: 'key',\n        value: 'Value'\n      }]\n    }]\n  }]);\n  const [testInput, setTestInput] = useState('{ \"age\": 28 }');\n  const [testResult, setTestResult] = useState(null);\n  const [showTestResult, setShowTestResult] = useState(false);\n  const [resultTrace, setResultTrace] = useState([]);\n\n  // 更新规则表达式\n  const handleRuleExpressionChange = (id, value) => {\n    setRules(rules.map(rule => rule.id === id ? {\n      ...rule,\n      expression: value\n    } : rule));\n  };\n\n  // 更新规则名称\n  const updateRuleName = (id, name) => {\n    setRules(rules.map(rule => rule.id === id ? {\n      ...rule,\n      name\n    } : rule));\n  };\n\n  // 处理动作变更\n  const handleActionChange = (ruleId, decisionId, actionIndex, field, value) => {\n    setRules(rules.map(rule => {\n      if (rule.id === ruleId) {\n        const updatedDecisions = rule.decisions.map(decision => {\n          if (decision.id === decisionId) {\n            const updatedActions = [...decision.actions];\n            updatedActions[actionIndex] = {\n              ...updatedActions[actionIndex],\n              [field]: value\n            };\n            return {\n              ...decision,\n              actions: updatedActions\n            };\n          }\n          return decision;\n        });\n        return {\n          ...rule,\n          decisions: updatedDecisions\n        };\n      }\n      return rule;\n    }));\n  };\n\n  // 添加新的决策动作\n  const addNewDecisionAction = (ruleId, decisionId) => {\n    setRules(rules.map(rule => {\n      if (rule.id === ruleId) {\n        const updatedDecisions = rule.decisions.map(decision => {\n          if (decision.id === decisionId) {\n            return {\n              ...decision,\n              actions: [...decision.actions, {\n                type: 'SET',\n                key: '',\n                value: '',\n                target: 'ML_DECISION'\n              }]\n            };\n          }\n          return decision;\n        });\n        return {\n          ...rule,\n          decisions: updatedDecisions\n        };\n      }\n      return rule;\n    }));\n  };\n\n  // 删除决策动作\n  const deleteDecisionAction = (ruleId, decisionId, actionIndex) => {\n    setRules(rules.map(rule => {\n      if (rule.id === ruleId) {\n        const updatedDecisions = rule.decisions.map(decision => {\n          if (decision.id === decisionId) {\n            if (decision.actions.length <= 1) {\n              alert('至少需要保留一个动作');\n              return decision;\n            }\n            const updatedActions = [...decision.actions];\n            updatedActions.splice(actionIndex, 1);\n            return {\n              ...decision,\n              actions: updatedActions\n            };\n          }\n          return decision;\n        });\n        return {\n          ...rule,\n          decisions: updatedDecisions\n        };\n      }\n      return rule;\n    }));\n  };\n\n  // 添加新的决策项\n  const addNewDecision = ruleId => {\n    setRules(rules.map(rule => {\n      if (rule.id === ruleId) {\n        const newDecisionId = Math.max(...rule.decisions.map(d => d.id), 0) + 1;\n        return {\n          ...rule,\n          decisions: [...rule.decisions, {\n            id: newDecisionId,\n            name: `决策${newDecisionId}`,\n            actions: [{\n              type: 'SET',\n              key: '',\n              value: '',\n              target: 'ML_DECISION'\n            }]\n          }]\n        };\n      }\n      return rule;\n    }));\n  };\n\n  // 删除决策项\n  const deleteDecision = (ruleId, decisionId) => {\n    setRules(rules.map(rule => {\n      if (rule.id === ruleId) {\n        // 确保至少保留一个决策项\n        if (rule.decisions.length > 1) {\n          return {\n            ...rule,\n            decisions: rule.decisions.filter(d => d.id !== decisionId)\n          };\n        }\n      }\n      return rule;\n    }));\n  };\n\n  // 处理测试输入变更\n  const handleTestInputChange = e => {\n    setTestInput(e.target.value);\n  };\n\n  // 运行测试\n  const runTest = () => {\n    try {\n      const input = JSON.parse(testInput);\n      const results = rules.map(rule => {\n        try {\n          // 使用eval执行规则表达式，实际生产环境应使用更安全的方式\n          const age = input.age;\n          const balance = input.balance || 0;\n          const score = input.score || 0;\n          const hasBadRecord = input.hasBadRecord || false;\n          const level = input.level || '';\n          const points = input.points || 0;\n\n          // 处理level字符串比较\n          const processedExpression = rule.expression.replace(/level\\s*==\\s*([A-Z]+)/g, (match, p1) => `level == '${p1}'`);\n          const isMatch = eval(processedExpression);\n          return {\n            ruleName: rule.name,\n            expression: rule.expression,\n            matched: isMatch,\n            decision: isMatch ? rule.decisions[0].actions : []\n          };\n        } catch (error) {\n          return {\n            ruleName: rule.name,\n            expression: rule.expression,\n            matched: false,\n            error: error.message\n          };\n        }\n      });\n\n      // 生成测试轨迹\n      const trace = results.map(result => ({\n        ruleName: result.ruleName,\n        expression: result.expression,\n        passed: result.matched,\n        result: result.matched ? '通过' : result.error ? `错误: ${result.error}` : '未通过'\n      }));\n\n      // 找到第一个匹配的规则结果\n      const firstMatch = results.find(result => result.matched);\n      const finalResult = firstMatch ? '规则命中' : '未命中任何规则';\n      setTestResult({\n        results,\n        finalResult\n      });\n      setResultTrace(trace);\n      setShowTestResult(true);\n    } catch (error) {\n      alert('输入JSON格式错误: ' + error.message);\n    }\n  };\n\n  // 添加新规则\n  const addNewRule = () => {\n    const newId = Math.max(...rules.map(r => r.id)) + 1;\n    setRules([...rules, {\n      id: newId,\n      expression: '',\n      name: `规则${newId}`,\n      decisions: [{\n        id: newId,\n        name: `规则${newId}决策`,\n        actions: [{\n          type: 'SET',\n          key: '',\n          value: '',\n          target: 'ML_DECISION'\n        }]\n      }]\n    }]);\n  };\n\n  // 删除规则\n  const handleDeleteRule = id => {\n    if (rules.length <= 1) {\n      alert('至少需要保留一条规则');\n      return;\n    }\n    setRules(rules.filter(rule => rule.id !== id));\n  };\n\n  // 复制规则\n  const handleCopyRule = id => {\n    const ruleToCopy = rules.find(rule => rule.id === id);\n    if (!ruleToCopy) return;\n    const newId = Math.max(...rules.map(r => r.id)) + 1;\n    const newRule = {\n      ...ruleToCopy,\n      id: newId,\n      name: `${ruleToCopy.name} (复制)`,\n      decisions: ruleToCopy.decisions.map(decision => ({\n        ...decision,\n        id: newId,\n        name: `${decision.name} (复制)`\n      }))\n    };\n    setRules([...rules, newRule]);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"app-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"\\u89C4\\u5219\\u7EC4\\uFF1A\\u89C4\\u5219\\u7EC41\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"header-actions\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn btn-secondary\",\n          children: \"\\u53D6\\u6D88\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn btn-secondary\",\n          children: \"\\u786E\\u5B9A\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn btn-primary\",\n          children: \"\\u4FDD\\u5B58\\u5E76\\u542F\\u7528\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"rule-editor\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"rule-section\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"section-title\",\n          children: \"\\u89C4\\u5219\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 269,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"rule-list\",\n          children: rules.map(rule => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"rule-item\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              className: \"rule-expression\",\n              value: rule.expression,\n              onChange: e => handleRuleExpressionChange(rule.id, e.target.value),\n              placeholder: \"\\u8F93\\u5165\\u89C4\\u5219\\u8868\\u8FBE\\u5F0F\\uFF0C\\u4F8B\\u5982\\uFF1Aage >= 18\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 273,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn btn-small btn-secondary\",\n              children: \"\\u7F16\\u8F91\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 280,\n              columnNumber: 17\n            }, this)]\n          }, rule.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 272,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn btn-secondary\",\n          onClick: addNewRule,\n          children: \"+ \\u6DFB\\u52A0\\u89C4\\u5219\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 284,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 268,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"decision-section\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"section-title\",\n          children: \"\\u6267\\u884C\\u51B3\\u7B56\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 290,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"decision-list\",\n          children: decisions.map(decision => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"decision-item\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"decision-header\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"decision-type\",\n                children: decision.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 295,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"btn btn-small btn-secondary\",\n                children: \"\\u7F16\\u8F91\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 296,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 294,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"action-list\",\n              children: decision.actions.map((action, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"action-row\",\n                children: [/*#__PURE__*/_jsxDEV(\"select\", {\n                  className: \"action-select\",\n                  value: action.target,\n                  onChange: e => handleActionChange(decision.id, index, 'target', e.target.value),\n                  children: /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"ML_DECISION\",\n                    children: \"ML_DECISION\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 306,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 301,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                  className: \"action-select\",\n                  value: action.type,\n                  onChange: e => handleActionChange(decision.id, index, 'type', e.target.value),\n                  children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"SET\",\n                    children: \"SET\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 313,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"INCR\",\n                    children: \"INCR\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 314,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 308,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"text\",\n                  className: \"action-input\",\n                  value: action.key,\n                  onChange: e => handleActionChange(decision.id, index, 'key', e.target.value),\n                  placeholder: \"key\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 316,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"text\",\n                  className: \"action-input\",\n                  value: action.value,\n                  onChange: e => handleActionChange(decision.id, index, 'value', e.target.value),\n                  placeholder: \"value\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 323,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"btn btn-small btn-secondary\",\n                  children: \"+ \\u5192\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 330,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"btn btn-small btn-secondary\",\n                  children: \"\\u7F16\\u8F91\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 331,\n                  columnNumber: 23\n                }, this)]\n              }, index, true, {\n                fileName: _jsxFileName,\n                lineNumber: 300,\n                columnNumber: 21\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 298,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn btn-small btn-secondary\",\n              onClick: () => addNewDecisionAction(decision.id),\n              children: \"+ \\u6DFB\\u52A0\\u52A8\\u4F5C\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 335,\n              columnNumber: 17\n            }, this)]\n          }, decision.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 293,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 291,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 289,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 267,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"test-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"section-title\",\n        children: \"\\u6D4B\\u8BD5\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 348,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n        className: \"test-input\",\n        value: testInput,\n        onChange: handleTestInputChange,\n        placeholder: \"\\u8F93\\u5165\\u6D4B\\u8BD5\\u6570\\u636E\\uFF0C\\u4F8B\\u5982\\uFF1A{ \\\"age\\\": 28 }\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 349,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn btn-primary\",\n        onClick: runTest,\n        children: \"\\u8FD0\\u884C\\u6D4B\\u8BD5\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 355,\n        columnNumber: 9\n      }, this), testResult && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"test-results\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"\\u6D4B\\u8BD5\\u7ED3\\u679C\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 361,\n          columnNumber: 13\n        }, this), testResult.map((result, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"result-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"result-label\",\n              children: \"\\u89C4\\u5219:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 365,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"result-value\",\n              children: result.ruleName\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 366,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 364,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"result-label\",\n              children: \"\\u8868\\u8FBE\\u5F0F:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 369,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"result-value\",\n              children: result.expression\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 370,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 368,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"result-label\",\n              children: \"\\u5339\\u914D\\u7ED3\\u679C:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 373,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"result-value\",\n              children: result.matched ? 'true' : 'false'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 374,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 372,\n            columnNumber: 17\n          }, this), result.error && /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"result-label\",\n              children: \"\\u9519\\u8BEF:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 378,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"result-value\",\n              children: result.error\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 379,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 377,\n            columnNumber: 19\n          }, this), result.decision && /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"result-label\",\n              children: \"\\u6267\\u884C\\u51B3\\u7B56:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 384,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"result-value\",\n              children: JSON.stringify(result.decision, null, 2)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 385,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 383,\n            columnNumber: 19\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 363,\n          columnNumber: 15\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 360,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 347,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 257,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"o2WgSxq3/l4KZrSvXQwazOzJYUQ=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","jsxDEV","_jsxDEV","App","_s","rules","setRules","id","name","expression","decisions","actions","type","key","value","target","testInput","setTestInput","testResult","setTestResult","showTestResult","setShowTestResult","resultTrace","setResultTrace","handleRuleExpressionChange","map","rule","updateRuleName","handleActionChange","ruleId","decisionId","actionIndex","field","updatedDecisions","decision","updatedActions","addNewDecisionAction","deleteDecisionAction","length","alert","splice","addNewDecision","newDecisionId","Math","max","d","deleteDecision","filter","handleTestInputChange","e","runTest","input","JSON","parse","results","age","balance","score","hasBadRecord","level","points","processedExpression","replace","match","p1","isMatch","eval","ruleName","matched","error","message","trace","result","passed","firstMatch","find","finalResult","addNewRule","newId","r","handleDeleteRule","handleCopyRule","ruleToCopy","newRule","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onChange","placeholder","onClick","action","index","stringify","_c","$RefreshReg$"],"sources":["/Users/viyondpay/opensource/dynamic_decision/front/src/App.js"],"sourcesContent":["import React, { useState } from 'react';\n\nfunction App() {\n  // 修改数据结构：每个规则拥有自己的决策\n  const [rules, setRules] = useState([\n    {\n      id: 1, \n      name: '规则1', \n      expression: 'age >= 18', \n      decisions: [\n        {\n          id: 1,\n          name: '规则1决策',\n          actions: [\n            { type: 'SET', key: 'result', value: 'true', target: 'ML_DECISION' }\n          ]\n        }\n      ]\n    },\n    {\n      id: 2, \n      name: '规则2', \n      expression: 'age <= 18', \n      decisions: [\n        {\n          id: 2,\n          name: '规则2决策',\n          actions: [\n            { type: 'SET', key: 'result', value: 'false', target: 'ML_DECISION' },\n            { type: 'INCR', key: 'key', value: 'Value' }\n          ]\n        }\n      ]\n    }\n  ]);\n\n  const [testInput, setTestInput] = useState('{ \"age\": 28 }');\n  const [testResult, setTestResult] = useState(null);\n  const [showTestResult, setShowTestResult] = useState(false);\n  const [resultTrace, setResultTrace] = useState([]);\n\n  // 更新规则表达式\n  const handleRuleExpressionChange = (id, value) => {\n    setRules(rules.map(rule => \n      rule.id === id ? { ...rule, expression: value } : rule\n    ));\n  };\n\n  // 更新规则名称\n  const updateRuleName = (id, name) => {\n    setRules(rules.map(rule => \n      rule.id === id ? { ...rule, name } : rule\n    ));\n  };\n\n  // 处理动作变更\n  const handleActionChange = (ruleId, decisionId, actionIndex, field, value) => {\n    setRules(rules.map(rule => {\n      if (rule.id === ruleId) {\n        const updatedDecisions = rule.decisions.map(decision => {\n          if (decision.id === decisionId) {\n            const updatedActions = [...decision.actions];\n            updatedActions[actionIndex] = { ...updatedActions[actionIndex], [field]: value };\n            return { ...decision, actions: updatedActions };\n          }\n          return decision;\n        });\n        return { ...rule, decisions: updatedDecisions };\n      }\n      return rule;\n    }));\n  };\n\n  // 添加新的决策动作\n  const addNewDecisionAction = (ruleId, decisionId) => {\n    setRules(rules.map(rule => {\n      if (rule.id === ruleId) {\n        const updatedDecisions = rule.decisions.map(decision => {\n          if (decision.id === decisionId) {\n            return { \n              ...decision, \n              actions: [...decision.actions, { type: 'SET', key: '', value: '', target: 'ML_DECISION' }]\n            };\n          }\n          return decision;\n        });\n        return { ...rule, decisions: updatedDecisions };\n      }\n      return rule;\n    }));\n  };\n\n  // 删除决策动作\n  const deleteDecisionAction = (ruleId, decisionId, actionIndex) => {\n    setRules(rules.map(rule => {\n      if (rule.id === ruleId) {\n        const updatedDecisions = rule.decisions.map(decision => {\n          if (decision.id === decisionId) {\n            if (decision.actions.length <= 1) {\n              alert('至少需要保留一个动作');\n              return decision;\n            }\n            const updatedActions = [...decision.actions];\n            updatedActions.splice(actionIndex, 1);\n            return { ...decision, actions: updatedActions };\n          }\n          return decision;\n        });\n        return { ...rule, decisions: updatedDecisions };\n      }\n      return rule;\n    }));\n  };\n\n  // 添加新的决策项\n  const addNewDecision = (ruleId) => {\n    setRules(rules.map(rule => {\n      if (rule.id === ruleId) {\n        const newDecisionId = Math.max(...rule.decisions.map(d => d.id), 0) + 1;\n        return { \n          ...rule, \n          decisions: [...rule.decisions, {\n            id: newDecisionId,\n            name: `决策${newDecisionId}`,\n            actions: [{ type: 'SET', key: '', value: '', target: 'ML_DECISION' }]\n          }]\n        };\n      }\n      return rule;\n    }));\n  };\n\n  // 删除决策项\n  const deleteDecision = (ruleId, decisionId) => {\n    setRules(rules.map(rule => {\n      if (rule.id === ruleId) {\n        // 确保至少保留一个决策项\n        if (rule.decisions.length > 1) {\n          return { \n            ...rule, \n            decisions: rule.decisions.filter(d => d.id !== decisionId)\n          };\n        }\n      }\n      return rule;\n    }));\n  };\n\n  // 处理测试输入变更\n  const handleTestInputChange = (e) => {\n    setTestInput(e.target.value);\n  };\n\n  // 运行测试\n  const runTest = () => {\n    try {\n      const input = JSON.parse(testInput);\n      const results = rules.map(rule => {\n        try {\n          // 使用eval执行规则表达式，实际生产环境应使用更安全的方式\n          const age = input.age;\n          const balance = input.balance || 0;\n          const score = input.score || 0;\n          const hasBadRecord = input.hasBadRecord || false;\n          const level = input.level || '';\n          const points = input.points || 0;\n          \n          // 处理level字符串比较\n          const processedExpression = rule.expression.replace(/level\\s*==\\s*([A-Z]+)/g, (match, p1) => `level == '${p1}'`);\n          const isMatch = eval(processedExpression);\n          \n          return { \n            ruleName: rule.name, \n            expression: rule.expression, \n            matched: isMatch,\n            decision: isMatch ? rule.decisions[0].actions : []\n          };\n        } catch (error) {\n          return { \n            ruleName: rule.name, \n            expression: rule.expression, \n            matched: false,\n            error: error.message\n          };\n        }\n      });\n      \n      // 生成测试轨迹\n      const trace = results.map(result => ({\n        ruleName: result.ruleName,\n        expression: result.expression,\n        passed: result.matched,\n        result: result.matched ? '通过' : result.error ? `错误: ${result.error}` : '未通过'\n      }));\n      \n      // 找到第一个匹配的规则结果\n      const firstMatch = results.find(result => result.matched);\n      const finalResult = firstMatch ? '规则命中' : '未命中任何规则';\n      \n      setTestResult({ results, finalResult });\n      setResultTrace(trace);\n      setShowTestResult(true);\n    } catch (error) {\n      alert('输入JSON格式错误: ' + error.message);\n    }\n  };\n\n  // 添加新规则\n  const addNewRule = () => {\n    const newId = Math.max(...rules.map(r => r.id)) + 1;\n    setRules([...rules, { \n      id: newId, \n      expression: '', \n      name: `规则${newId}`,\n      decisions: [\n        {\n          id: newId,\n          name: `规则${newId}决策`,\n          actions: [\n            { type: 'SET', key: '', value: '', target: 'ML_DECISION' }\n          ]\n        }\n      ]\n    }]);\n  };\n\n  // 删除规则\n  const handleDeleteRule = (id) => {\n    if (rules.length <= 1) {\n      alert('至少需要保留一条规则');\n      return;\n    }\n    setRules(rules.filter(rule => rule.id !== id));\n  };\n\n  // 复制规则\n  const handleCopyRule = (id) => {\n    const ruleToCopy = rules.find(rule => rule.id === id);\n    if (!ruleToCopy) return;\n    \n    const newId = Math.max(...rules.map(r => r.id)) + 1;\n    const newRule = {\n      ...ruleToCopy,\n      id: newId,\n      name: `${ruleToCopy.name} (复制)`,\n      decisions: ruleToCopy.decisions.map(decision => ({\n        ...decision,\n        id: newId,\n        name: `${decision.name} (复制)`\n      }))\n    };\n    \n    setRules([...rules, newRule]);\n  };\n\n  return (\n    <div className=\"app-container\">\n      <div className=\"header\">\n        <h1>规则组：规则组1</h1>\n        <div className=\"header-actions\">\n          <button className=\"btn btn-secondary\">取消</button>\n          <button className=\"btn btn-secondary\">确定</button>\n          <button className=\"btn btn-primary\">保存并启用</button>\n        </div>\n      </div>\n\n      <div className=\"rule-editor\">\n        <div className=\"rule-section\">\n          <div className=\"section-title\">规则</div>\n          <div className=\"rule-list\">\n            {rules.map((rule) => (\n              <div key={rule.id} className=\"rule-item\">\n                <input\n                  type=\"text\"\n                  className=\"rule-expression\"\n                  value={rule.expression}\n                  onChange={(e) => handleRuleExpressionChange(rule.id, e.target.value)}\n                  placeholder=\"输入规则表达式，例如：age >= 18\"\n                />\n                <button className=\"btn btn-small btn-secondary\">编辑</button>\n              </div>\n            ))}\n          </div>\n          <button className=\"btn btn-secondary\" onClick={addNewRule}>\n            + 添加规则\n          </button>\n        </div>\n\n        <div className=\"decision-section\">\n          <div className=\"section-title\">执行决策</div>\n          <div className=\"decision-list\">\n            {decisions.map((decision) => (\n              <div key={decision.id} className=\"decision-item\">\n                <div className=\"decision-header\">\n                  <span className=\"decision-type\">{decision.name}</span>\n                  <button className=\"btn btn-small btn-secondary\">编辑</button>\n                </div>\n                <div className=\"action-list\">\n                  {decision.actions.map((action, index) => (\n                    <div key={index} className=\"action-row\">\n                      <select\n                        className=\"action-select\"\n                        value={action.target}\n                        onChange={(e) => handleActionChange(decision.id, index, 'target', e.target.value)}\n                      >\n                        <option value=\"ML_DECISION\">ML_DECISION</option>\n                      </select>\n                      <select\n                        className=\"action-select\"\n                        value={action.type}\n                        onChange={(e) => handleActionChange(decision.id, index, 'type', e.target.value)}\n                      >\n                        <option value=\"SET\">SET</option>\n                        <option value=\"INCR\">INCR</option>\n                      </select>\n                      <input\n                        type=\"text\"\n                        className=\"action-input\"\n                        value={action.key}\n                        onChange={(e) => handleActionChange(decision.id, index, 'key', e.target.value)}\n                        placeholder=\"key\"\n                      />\n                      <input\n                        type=\"text\"\n                        className=\"action-input\"\n                        value={action.value}\n                        onChange={(e) => handleActionChange(decision.id, index, 'value', e.target.value)}\n                        placeholder=\"value\"\n                      />\n                      <button className=\"btn btn-small btn-secondary\">+ 冒</button>\n                      <button className=\"btn btn-small btn-secondary\">编辑</button>\n                    </div>\n                  ))}\n                </div>\n                <button \n                  className=\"btn btn-small btn-secondary\"\n                  onClick={() => addNewDecisionAction(decision.id)}\n                >\n                  + 添加动作\n                </button>\n              </div>\n            ))}\n          </div>\n        </div>\n      </div>\n\n      <div className=\"test-section\">\n        <div className=\"section-title\">测试</div>\n        <textarea\n          className=\"test-input\"\n          value={testInput}\n          onChange={handleTestInputChange}\n          placeholder='输入测试数据，例如：{ \"age\": 28 }'\n        ></textarea>\n        <button className=\"btn btn-primary\" onClick={runTest}>\n          运行测试\n        </button>\n        \n        {testResult && (\n          <div className=\"test-results\">\n            <h3>测试结果</h3>\n            {testResult.map((result, index) => (\n              <div key={index} className=\"result-item\">\n                <div>\n                  <span className=\"result-label\">规则:</span>\n                  <span className=\"result-value\">{result.ruleName}</span>\n                </div>\n                <div>\n                  <span className=\"result-label\">表达式:</span>\n                  <span className=\"result-value\">{result.expression}</span>\n                </div>\n                <div>\n                  <span className=\"result-label\">匹配结果:</span>\n                  <span className=\"result-value\">{result.matched ? 'true' : 'false'}</span>\n                </div>\n                {result.error && (\n                  <div>\n                    <span className=\"result-label\">错误:</span>\n                    <span className=\"result-value\">{result.error}</span>\n                  </div>\n                )}\n                {result.decision && (\n                  <div>\n                    <span className=\"result-label\">执行决策:</span>\n                    <span className=\"result-value\">\n                      {JSON.stringify(result.decision, null, 2)}\n                    </span>\n                  </div>\n                )}\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}